<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · RunStatistics</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://bat.github.io/RunStatistics.jl/stable/introduction/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="RunStatistics logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="RunStatistics logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RunStatistics</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Motivation"><span>Motivation</span></a></li><li><a class="tocitem" href="#The-Squares-test-statistic"><span>The Squares test statistic</span></a></li><li><a class="tocitem" href="#Interpreting-the-Squares-statistic"><span>Interpreting the Squares statistic</span></a></li></ul></li><li><a class="tocitem" href="../guide/">Guide</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bat/RunStatistics.jl/blob/master/docs/src/introduction.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><hr/><p>This page provides a summarized explanation for the <em>Squares test statistic</em> <span>$T$</span> and when and in what context it can be used. For a comprehensive derivation and explanation see <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> and <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>.</p><ul><li><a href="#Introduction">Introduction</a></li><li class="no-marker"><ul><li><a href="#Motivation">Motivation</a></li><li><a href="#The-Squares-test-statistic">The Squares test statistic</a></li><li><a href="#Interpreting-the-Squares-statistic">Interpreting the Squares statistic</a></li><li class="no-marker"><ul><li><a href="#Approximation-for-large-numbers-of-observations">Approximation for large numbers of observations</a></li></ul></li></ul></li></ul><h2 id="Motivation"><a class="docs-heading-anchor" href="#Motivation">Motivation</a><a id="Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Motivation" title="Permalink"></a></h2><hr/><p>One of the most common tasks in scientific inference is comparing observations and model predictions. Based on this comparison, the hypothesized model may be either accepted or rejected. In the latter case usually an improved model is sought. The comparison between observations and the new model is then repeated until a satisfactory model has been constructed.</p><p>In model validation the goal is to provide quantitative test procedures. The standard approach consists of defining a scalar function of the data <span>$D$</span>, called <a href="https://en.wikipedia.org/wiki/Test_statistic"><em>test statistic</em></a> <span>$T (D)$</span>, such that a large value of <span>$T$</span> indicates a large deviation of the data from the expectations under the hypothesized model <span>$\mathcal{H}$</span>. Correspondingly, small <span>$T$</span> is seen as good agreement.</p><h2 id="The-Squares-test-statistic"><a class="docs-heading-anchor" href="#The-Squares-test-statistic">The Squares test statistic</a><a id="The-Squares-test-statistic-1"></a><a class="docs-heading-anchor-permalink" href="#The-Squares-test-statistic" title="Permalink"></a></h2><hr/><p>The <code>Squares test statistic</code> or <code>Squares statistic</code> for short, in the following denoted with <span>$T$</span>, is a test statistic sensitive to local deviations of the data from expectations within an ordered data set<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><p>It supplements the classic <a href="https://en.wikipedia.org/wiki/Chi-squared_test"><span>$\chi^2$</span> test</a> which ignores the ordering of observations and provides additional sensitivity to local deviations from expectations. </p><p>The <code>Squares statistic</code> <span>$T$</span> can be defined for data that follows any symmetric distribution<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, but in this package only data with a <a href="https://en.wikipedia.org/wiki/Normal_distribution">gaussian probability distribution</a> is considered:</p><p class="math-container">\[\begin{align}
X_i \sim \mathcal{N}(\mu_i, \sigma_i^2)
\end{align}\]</p><p>The hypothesis <span>$\mathcal{H}$</span> for the data is:</p><ul><li>All observations <span>$\{X_i\}$</span> are independent. </li><li>Each observation is normally distributed, <span>$X_i \sim \mathcal{N}(\mu_i, \sigma^2_i)$</span></li><li>Mean <span>$\mu_i$</span> and variance <span>$\sigma^2_i$</span> are known.</li></ul><p><span>$T$</span> is based on <code>runs</code> of weighted deviations from a mean value, observed in samples <span>$X_i$</span> from independent normal distributions. </p><p>A <code>run</code> in this context refers to a sequence of observations that share a common attribute commonly called a <code>success</code>. Here an observation is called a <em>success</em>, <span>$S$</span>, if the observed value exceeds the expected value. Similarly, an expected value exceeding the observation is considered a <em>failure</em>, <span>$F$</span>.</p><p><span>$T$</span> is formally defined via:</p><hr/><ul><li><p>Split the data <span>${X_i}$</span> into runs. Keep the success runs and ignore the   failure runs. Denote by <span>$A_j = \{X_{j_1} ,X_{j_2}, ...\}$</span> the set of    observations in the <span>$j$</span>-th success run.</p></li><li><p>Associate a weight <span>$\omega(A_j)$</span> with each success run:</p></li></ul><p class="math-container">\[\begin{align}
\omega(A_j) \equiv \chi_{run,j}^2 = \displaystyle\sum_i\frac{(X_i-\mu_i)^2}{\sigma_i^2}
\end{align}\]</p><ul><li>Choose <span>$T$</span> as the largest weight of any run in the entire sequence of observed data:</li></ul><p class="math-container">\[\begin{align}
T \equiv \max_j \omega(A_j)
\end{align}\]</p><hr/><p>Note that the choice for the weight <span>$\omega(A_j)$</span> implemented in this package is only one of the most significant ones, more general options are available (see section 1. of <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>).</p><p>Consider for example an observed data sequence of: </p><p class="math-container">\[SSSFFSFFFSSF \]</p><p>where <span>$S$</span> denotes a <em>success</em>, a value above the expected value, and <span>$F$</span> a <em>failure</em>. In accordance with the above steps, only the success runs are considered:</p><p class="math-container">\[\underbrace{\mathbf{SSS}}_{A_1}~~FF~\underbrace{\mathbf{S}}_{A_2}~FFF~\underbrace{\mathbf{SS}}_{A_3}~F \]</p><p>For each of the three success runs <span>$A_j$</span> observed in this example, the weight <span>$\omega(A_j)=\chi_{run,j}^2$</span> is calculated. The value <span>$T_{obs}$</span>, denoting the observed value of <span>$T$</span> in this sequence of data is then the maximum of the three weights <span>$T_{obs} = \max_j \omega(A_j)$</span>.</p><h2 id="Interpreting-the-Squares-statistic"><a class="docs-heading-anchor" href="#Interpreting-the-Squares-statistic">Interpreting the Squares statistic</a><a id="Interpreting-the-Squares-statistic-1"></a><a class="docs-heading-anchor-permalink" href="#Interpreting-the-Squares-statistic" title="Permalink"></a></h2><hr/><p>To facilitate the interpretation of <span>$T$</span> (how large is too large?), it is useful to introduce the <a href="https://en.wikipedia.org/wiki/P-value"><em>p-value</em></a> <span>$p$</span>. Assuming <span>$\mathcal{H}$</span>, the p-value is defined as the tail area probability to randomly sample a value of <span>$T$</span> larger than or equal to <span>$T_{obs}$</span>, the value of <span>$T$</span> observed in the data:</p><p class="math-container">\[\begin{align}
p \equiv P (T ≥ T_{obs} ~|~ \mathcal{H}) 
\end{align}\]</p><p>If <span>$\mathcal{H}$</span> is correct and all parameters are fixed, then <span>$p$</span> is a random variable with uniform distribution on <span>$[0, 1]$</span>. An incorrect model will typically yield smaller values of <span>$p$</span>.</p><h3 id="Approximation-for-large-numbers-of-observations"><a class="docs-heading-anchor" href="#Approximation-for-large-numbers-of-observations">Approximation for large numbers of observations</a><a id="Approximation-for-large-numbers-of-observations-1"></a><a class="docs-heading-anchor-permalink" href="#Approximation-for-large-numbers-of-observations" title="Permalink"></a></h3><hr/><p>The cost for calculating the exact <code>p-value</code> for the Squares statistic as described in the initial paper<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, scales with the number <span>$N$</span> of observations in a sequence of data like <span>$\exp[N^{\frac{1}{2}}]/N$</span> and quickly grows too large for <span>$N \gtrsim 80$</span>. </p><p>The authors derived an approximation for large numbers of data in the follow-up paper<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>.</p><p>The underlying principle is to split the (long) total sequence of observed data into shorter sequences, for which the p-value can be computed exactly. An approximate p-value <span>$p$</span> for the entire observed data sequence can then be extrapolated. The approximation is constructed to have high accuracy in the region of interest, for small values for <span>$p$</span>. </p><p>For a comprehensive explanation see section II. of <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Frederik Beaujean and Allen Caldwell. <em>A Test Statistic for Weighted Runs</em>. Journal of Statistical Planning and Inference 141, no. 11 (November 2011): 3437–46. <a href="https://dx.doi.org/10.1016/j.jspi.2011.04.022">doi:10.1016/j.jspi.2011.04.022</a> <a href="https://arxiv.org/abs/1005.3233">arXiv:1005.3233</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Frederik Beaujean and Allen Caldwell. <em>Is the bump significant? An axion-search example</em> <a href="https://arxiv.org/abs/1710.06642">arXiv:1710.06642</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../guide/">Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Wednesday 2 February 2022 16:13">Wednesday 2 February 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
